/* ==========================================================
   C3X4.0 â€” BRASIL INDEPENDENTE
   JS ULTRA IMERSIVO Â· PROFUNDIDADE Â· PARALLAX Â· HOVER 3D
========================================================== */

(() => {
  // =========================
  // VARIÃVEIS
  // =========================
  const sections = document.querySelectorAll("section[data-speed]");
  const blocks = document.querySelectorAll(".bloco, .estado, .valor");
  const stars = document.querySelectorAll("#espaco-sideral .estrela");
  let scrollY = window.scrollY;

  // =========================
  // FUNÃ‡ÃƒO DE PARALLAX
  // =========================
  const parallaxScroll = () => {
    scrollY = window.scrollY;

    // SeÃ§Ãµes
    sections.forEach(section => {
      const speed = parseFloat(section.dataset.speed);
      section.style.transform = `translateY(${scrollY * speed * -0.3}px)`;
    });

    // Blocos flutuantes (hover jÃ¡ tratado via CSS)
    blocks.forEach(block => {
      const speed = parseFloat(block.dataset.speed || 0.1);
      block.style.transform = `translateY(${scrollY * speed * -0.2}px)`;
    });

    // Estrelas â€” efeito de profundidade leve
    stars.forEach((star, index) => {
      const depthFactor = 0.05 + (index / stars.length) * 0.1;
      star.style.transform = `translateY(${scrollY * depthFactor}px)`;
    });

    requestAnimationFrame(parallaxScroll);
  };

  // =========================
  // HOVER 3D DINÃ‚MICO PARA BLOCO
  // =========================
  blocks.forEach(block => {
    block.addEventListener("mousemove", e => {
      const rect = block.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      const rotateX = ((y - centerY) / centerY) * 5; // ajusta intensidade
      const rotateY = ((x - centerX) / centerX) * 5;
      block.style.transform = `rotateX(${-rotateX}deg) rotateY(${rotateY}deg) translateZ(0)`;
    });

    block.addEventListener("mouseleave", () => {
      block.style.transform = "rotateX(0deg) rotateY(0deg) translateZ(0)";
    });
  });

  // =========================
  // CLICK RÃPIDO NOS VALORES
  // =========================
  const valores = document.querySelectorAll(".valor[data-pix]");
  valores.forEach(valor => {
    valor.addEventListener("click", () => {
      const pix = valor.dataset.pix;
      navigator.clipboard.writeText(pix).then(() => {
        valor.textContent = `ğŸ“‹ Copiado! â€” ${valor.textContent}`;
        setTimeout(() => {
          valor.textContent = valor.textContent.replace("ğŸ“‹ Copiado! â€” ", "");
        }, 1500);
      });
    });
  });

  // =========================
  // INÃCIO
  // =========================
  requestAnimationFrame(parallaxScroll);

})();
